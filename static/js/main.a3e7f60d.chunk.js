(this.webpackJsonpproject=this.webpackJsonpproject||[]).push([[0],{69:function(e,t,a){"use strict";a.r(t),a.d(t,"store",(function(){return rt}));var c,r,n,i=a(1),s=a.n(i),l=a(19),o=a.n(l),d=a(4),u=a(2),j=a(7);!function(e){e.Root="/",e.Login="/login",e.MyList="/mylist",e.AddReview="/review",e.Film="/films/",e.Player="/player/",e.Page404="/page-not-found"}(c||(c={})),function(e){e.Auth="AUTH",e.NoAuth="NO_AUTH",e.Unknown="UNKNOWN"}(r||(r={})),function(e){e.PromoFilm="/promo",e.Films="/films",e.Login="/login",e.Logout="/logout",e.Similar="/similar",e.Comments="/comments",e.Favorite="/favorite"}(n||(n={}));var m,b={id:0,name:"",posterImage:"",previewImage:"",backgroundImage:"",backgroundColor:"",description:"",rating:0,scoresCount:0,director:"",starring:[],runTime:0,genre:"",released:0,isFavorite:!1,videoLink:"",previewVideoLink:""},h={id:0,email:"",name:"",avatarUrl:"",token:""},f="All genres";!function(e){e.Overview="Overview",e.Details="Details",e.Reviews="Reviews"}(m||(m={}));var O,v,x="film-nav__item--active";!function(e){e[e.Bad=0]="Bad",e[e.Normal=3]="Normal",e[e.Good=5]="Good",e[e.VeryGood=8]="VeryGood",e[e.Awesome=10]="Awesome"}(O||(O={})),function(e){e.Bad="Bad",e.Normal="Normal",e.Good="Good",e.VeryGood="Very good",e.Awesome="Awesome"}(v||(v={}));var _=["January","February","March","April","May","June","July","August","September","October","November","December"],p=a(0);var g=function(){return Object(p.jsx)("p",{children:"Loading ..."})},N=a(6);function w(e){var t=e.extraClassNameProp,a=void 0===t?"":t;return Object(p.jsxs)(N.a,{className:"logo__link ".concat(a),to:c.Root,children:[Object(p.jsx)("span",{className:"logo__letter logo__letter--1",children:"W"}),Object(p.jsx)("span",{className:"logo__letter logo__letter--2",children:"T"}),Object(p.jsx)("span",{className:"logo__letter logo__letter--3",children:"W"})]})}var y,k=s.a.memo(w),F=a(5),C=a.n(F),L=a(15);!function(e){e.LoadPromoFilm="data/loadPromoFilm",e.LoadFilms="data/loadFilms",e.LoadFilm="data/loadFilm",e.LoadSimilarFilms="data/loadSimilarFilms",e.LoadComments="data/loadComments",e.ChangeGenre="filmList/changeGenre",e.ChangeLimitCounter="filmList/changeLimitCounter",e.ChangeFilmNumberLimit="filmList/changeFilmNumberLimit",e.ResetFilmNumberLimit="filmList/resetFilmNumberLimit",e.RequireAuthorization="user/requireAuthorization",e.RequireLogout="user/requireLogout",e.ChangeUser="user/user",e.RedirectToRoute="filmList/redirectToRoute",e.LoadFavoriteFilms="user/loadFavoriteFilms",e.ResetFavoriteFilms="user/resetFavoriteFilms"}(y||(y={}));var A,R=Object(d.b)(y.LoadPromoFilm,(function(e){return{payload:e}})),S=Object(d.b)(y.LoadFilms,(function(e){return{payload:e}})),T=Object(d.b)(y.LoadFilm,(function(e){return{payload:e}})),D=Object(d.b)(y.LoadSimilarFilms,(function(e){return{payload:e}})),G=Object(d.b)(y.LoadComments,(function(e){return{payload:e}})),I=Object(d.b)(y.ChangeGenre,(function(e){return{payload:e}})),U=Object(d.b)(y.ChangeLimitCounter),P=Object(d.b)(y.ChangeFilmNumberLimit),M=Object(d.b)(y.ResetFilmNumberLimit),E=Object(d.b)(y.RequireAuthorization,(function(e){return{payload:e}})),B=Object(d.b)(y.RequireLogout),z=Object(d.b)(y.ChangeUser,(function(e){return{payload:e}})),q=Object(d.b)(y.RedirectToRoute,(function(e){return{payload:e}})),V=Object(d.b)(y.LoadFavoriteFilms,(function(e){return{payload:e}})),W=Object(d.b)(y.ResetFavoriteFilms),H="what-to-watch-token",J=a(36),Y=a.n(J);!function(e){e[e.Unauthorized=401]="Unauthorized"}(A||(A={}));function X(e){var t=Object.assign({},e,{posterImage:e.poster_image,previewImage:e.preview_image,backgroundImage:e.background_image,backgroundColor:e.background_color,videoLink:e.video_link,previewVideoLink:e.preview_video_link,scoresCount:e.scores_count,runTime:e.run_time,isFavorite:e.is_favorite});return delete t.poster_image,delete t.preview_image,delete t.background_color,delete t.background_image,delete t.video_link,delete t.preview_video_link,delete t.scores_count,delete t.run_time,delete t.is_favorite,t}function K(e){var t=Object.assign({},e,{avatarUrl:e.avatar_url});return delete t.avatar_url,t}var Q,Z,$=function(e){return function(){var t=Object(L.a)(C.a.mark((function t(a,r,i){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.get("".concat(n.Films,"/").concat(e)).then((function(e){e.status;var t=X(e.data);a(T(t))})).catch((function(){a(q(c.Page404))}));case 2:case"end":return t.stop()}}),t)})));return function(e,a,c){return t.apply(this,arguments)}}()},ee=a(22),te=a(12),ae={films:[],promoFilm:b,currentFilm:b,similarFilms:[],comments:[]},ce=Object(d.c)(ae,(function(e){e.addCase(S,(function(e,t){var a=t.payload;e.films=a})).addCase(R,(function(e,t){var a=t.payload;e.promoFilm=a})).addCase(T,(function(e,t){var a=t.payload;e.currentFilm=a})).addCase(D,(function(e,t){var a=t.payload;e.similarFilms=a})).addCase(G,(function(e,t){var a=t.payload;e.comments=a})).addCase(W,(function(e,t){e.promoFilm.isFavorite=!1,e.currentFilm.isFavorite=!1}))})),re={currentGenre:f,limitCounter:1,filmNumberLimit:8},ne=Object(d.c)(re,(function(e){e.addCase(I,(function(e,t){var a=t.payload;e.currentGenre=a})).addCase(U,(function(e,t){e.limitCounter=e.limitCounter+1})).addCase(P,(function(e,t){e.filmNumberLimit=e.filmNumberLimit*e.limitCounter})).addCase(M,(function(e,t){e.limitCounter=re.limitCounter,e.filmNumberLimit=re.filmNumberLimit}))})),ie={authorizationStatus:r.Unknown,user:h,isDataLoaded:!1,favoriteFilms:[]},se=Object(d.c)(ie,(function(e){e.addCase(E,(function(e,t){var a=t.payload;e.authorizationStatus=a,e.isDataLoaded=!0})).addCase(B,(function(e,t){e.authorizationStatus=r.NoAuth})).addCase(z,(function(e,t){var a=t.payload;e.user=a})).addCase(V,(function(e,t){var a=t.payload;e.favoriteFilms=a})).addCase(W,(function(e,t){e.favoriteFilms=ie.favoriteFilms}))}));!function(e){e.data="DATA",e.catalog="CATALOG",e.user="USER"}(Z||(Z={}));var le=Object(te.c)((Q={},Object(ee.a)(Q,Z.data,ce),Object(ee.a)(Q,Z.catalog,ne),Object(ee.a)(Q,Z.user,se),Q)),oe=function(e){return e[Z.user].authorizationStatus},de=function(e){return e[Z.user].isDataLoaded},ue=function(e){return e[Z.user].user},je=function(e){return e[Z.user].favoriteFilms};var me=function(){var e=Object(u.c)(oe),t=Object(u.c)(ue),a=Object(u.b)(),i=function(){a(function(){var e=Object(L.a)(C.a.mark((function e(t,a,c){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.delete(n.Logout),localStorage.removeItem(H),t(B()),t(z(h)),t(W());case 5:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}())};return Object(p.jsxs)("ul",{className:"user-block",children:[Object(p.jsx)("li",{className:"user-block__item",children:Object(p.jsx)("div",{className:"user-block__avatar",children:Object(p.jsx)(N.a,{to:c.MyList,children:Object(p.jsx)("img",{src:""===t.avatarUrl?"img/unauthorizedUser.png":t.avatarUrl,alt:"User avatar",width:"63",height:"63"})})})}),Object(p.jsx)("li",{className:"user-block__item",children:e===r.Auth?Object(p.jsx)("a",{className:"user-block__link",onClick:function(){return i()},children:"Sign out"}):Object(p.jsx)(N.a,{className:"user-block__link",to:c.Login,children:"Sign in"})})]})},be=a(37),he=function(e){return e[Z.catalog].currentGenre},fe=function(e){return e[Z.catalog].filmNumberLimit},Oe=function(e){return e[Z.data].films},ve=function(e){return e[Z.data].promoFilm},xe=function(e){return e[Z.data].currentFilm},_e=function(e){return e[Z.data].similarFilms},pe=function(e){return e[Z.data].comments};var ge=function(){var e=Object(u.c)(he),t=Object(u.c)(Oe),a=Object(u.b)(),r=t.map((function(e){return e.genre})),n=new Set(r),i=[f].concat(Object(be.a)(n));return Object(p.jsx)("ul",{className:"catalog__genres-list",children:i.map((function(t){return Object(p.jsx)("li",{className:"catalog__genres-item ".concat(t===e?"catalog__genres-item--active":""),children:Object(p.jsx)(N.a,{to:c.Root,className:"catalog__genres-link",onClick:function(e){!function(e){a(I(e)),a(M())}(e.currentTarget.innerText)},children:t})},t)}))})},Ne=a(8);var we=function(e){var t=e.link,a=e.poster,c=e.autoplay,r=e.muted,n=Object(i.useState)(!0),s=Object(Ne.a)(n,2),l=s[0],o=s[1],d=Object(i.useRef)(null);return Object(i.useEffect)((function(){return null!==d.current&&(d.current.onloadeddata=function(){return o(!l)}),function(){null!==d.current&&(d.current.onloadeddata=null,d.current=null)}}),[t,l]),Object(p.jsx)("video",{src:t,ref:d,className:"player__video",width:"280",height:"175",autoPlay:c,muted:r,poster:a})};var ye=function(e){var t=e.film,a=Object(i.useRef)(!1),r=Object(i.useState)(!1),n=Object(Ne.a)(r,2),s=n[0],l=n[1],o=Object(j.g)();return Object(p.jsxs)("article",{className:"small-film-card catalog__films-card",onMouseEnter:function(){a.current=!0,setTimeout((function(){a.current&&l(!0)}),1e3)},onMouseLeave:function(){a.current=!1,l(!1)},children:[Object(p.jsx)("div",{className:"small-film-card__image",onClick:function(){return o.push("".concat(c.Film).concat(t.id))},style:{cursor:"pointer"},children:s?Object(p.jsx)(we,{link:t.previewVideoLink,poster:t.posterImage,autoplay:!0,muted:!0}):Object(p.jsx)("img",{src:t.previewImage,alt:t.name,width:"280",height:"175"})}),Object(p.jsx)("h3",{className:"small-film-card__title",children:Object(p.jsx)(N.a,{className:"small-film-card__link",to:"".concat(c.Film).concat(t.id),children:t.name})})]})};function ke(e){var t=e.filmsCount,a=e.films;if(a&&a.length>0){var c=a.length<=t?a:a.slice(0,t);return Object(p.jsx)("div",{className:"catalog__films-list",children:c.map((function(e){var t="".concat(e.id);return Object(p.jsx)(ye,{film:e},t)}))})}return Object(p.jsx)("div",{className:"catalog__films-list",children:Object(p.jsx)("p",{children:"There is no data about films"})})}var Fe=s.a.memo(ke);var Ce=function(){var e=Object(u.b)();return Object(p.jsx)("div",{className:"catalog__more",children:Object(p.jsx)("button",{className:"catalog__button",type:"button",onClick:function(){e(U()),e(P())},children:"Show more"})})};function Le(){return Object(p.jsxs)("footer",{className:"page-footer",children:[Object(p.jsx)("div",{className:"logo",children:Object(p.jsx)(k,{extraClassNameProp:" logo__link--light"})}),Object(p.jsx)("div",{className:"copyright",children:Object(p.jsx)("p",{children:"\xa9 2019 What to watch Ltd."})})]})}var Ae=s.a.memo(Le);var Re=function(e){var t=e.id,a=Object(j.g)();return Object(p.jsxs)("button",{className:"btn btn--play film-card__button",type:"button",onClick:function(){return a.push("".concat(c.Player).concat(t))},children:[Object(p.jsx)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:Object(p.jsx)("use",{xlinkHref:"#play-s"})}),Object(p.jsx)("span",{children:"Play"})]})};var Se=function(e){var t=e.film,a=Object(u.b)(),r=function(){var e;a((e={filmId:t.id,status:!t.isFavorite},function(){var t=Object(L.a)(C.a.mark((function t(a,r,i){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.post("".concat(n.Favorite,"/").concat(e.filmId,"/").concat(!0===e.status?1:0)).then((function(e){var t=e.status,r=e.data;if(t&&t!==A.Unauthorized){var n=X(r);return n.id===rt.getState().DATA.promoFilm.id?void a(R(n)):void a(T(n))}a(q(c.Login))}));case 2:case"end":return t.stop()}}),t)})));return function(e,a,c){return t.apply(this,arguments)}}()))};return t.isFavorite?Object(p.jsxs)("button",{className:"btn btn--list film-card__button",type:"button",onClick:function(){return r()},children:[Object(p.jsx)("svg",{viewBox:"0 0 18 14",width:"18",height:"14",children:Object(p.jsx)("use",{xlinkHref:"#in-list"})}),Object(p.jsx)("span",{children:"My list"})]}):Object(p.jsxs)("button",{className:"btn btn--list film-card__button",type:"button",onClick:function(){return r()},children:[Object(p.jsx)("svg",{viewBox:"0 0 19 20",width:"19",height:"20",children:Object(p.jsx)("use",{xlinkHref:"#add"})}),Object(p.jsx)("span",{children:"My list"})]})};var Te=function(){var e=Object(u.c)(ve),t=Object(u.c)(he),a=Object(u.c)(Oe),c=Object(u.c)(fe),r=Object(u.c)(je),n=Object(u.b)(),s=e.id,l=e.name,o=e.genre,d=e.released,j=e.posterImage,m=e.backgroundImage,b=function(e,t){return e===f?t:t.filter((function(t){return t.genre===e}))}(t,a);return Object(i.useEffect)((function(){n(I(f)),n(M()),n(W);var t=r.find((function(t){return t.id===e.id}));t&&n(R(t))}),[n,r,e]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("section",{className:"film-card",children:[Object(p.jsx)("div",{className:"film-card__bg",children:Object(p.jsx)("img",{src:m,alt:l})}),Object(p.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(p.jsxs)("header",{className:"page-header film-card__head",children:[Object(p.jsx)("div",{className:"logo",children:Object(p.jsx)(k,{})}),Object(p.jsx)(me,{})]}),Object(p.jsx)("div",{className:"film-card__wrap",children:Object(p.jsxs)("div",{className:"film-card__info",children:[Object(p.jsx)("div",{className:"film-card__poster",children:Object(p.jsx)("img",{src:j,alt:"".concat(l," poster"),width:"218",height:"327"})}),Object(p.jsxs)("div",{className:"film-card__desc",children:[Object(p.jsx)("h2",{className:"film-card__title",children:l}),Object(p.jsxs)("p",{className:"film-card__meta",children:[Object(p.jsx)("span",{className:"film-card__genre",children:o}),Object(p.jsx)("span",{className:"film-card__year",children:d})]}),Object(p.jsxs)("div",{className:"film-card__buttons",children:[Object(p.jsx)(Re,{id:String(s)}),Object(p.jsx)(Se,{film:e})]})]})]})})]}),Object(p.jsxs)("div",{className:"page-content",children:[Object(p.jsxs)("section",{className:"catalog",children:[Object(p.jsx)("h2",{className:"catalog__title visually-hidden",children:"Catalog"}),Object(p.jsx)(ge,{}),Object(p.jsx)(Fe,{filmsCount:b.length>c?c:b.length,films:b}),b.length>c?Object(p.jsx)(Ce,{}):""]}),Object(p.jsx)(Ae,{})]})]})};var De=function(){var e=Object(u.b)(),t=function(t){e(function(e){var t=e.login,a=e.password;return function(){var e=Object(L.a)(C.a.mark((function e(i,s,l){var o,d;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.post(n.Login,{email:t,password:a});case 2:o=e.sent,s=(d=o.data).token,localStorage.setItem(H,s),i(z(K(d))),i(E(r.Auth)),i(q(c.MyList));case 8:case"end":return e.stop()}var s}),e)})));return function(t,a,c){return e.apply(this,arguments)}}()}(t))},a=Object(i.useRef)(null),s=Object(i.useRef)(null);return Object(p.jsxs)("div",{className:"user-page",children:[Object(p.jsxs)("header",{className:"page-header user-page__head",children:[Object(p.jsx)("div",{className:"logo",children:Object(p.jsx)(k,{})}),Object(p.jsx)("h1",{className:"page-title user-page__title",children:"Sign in"})]}),Object(p.jsx)("div",{className:"sign-in user-page__content",children:Object(p.jsxs)("form",{className:"sign-in__form",onSubmit:function(e){e.preventDefault(),null!==a.current&&null!==s.current&&t({login:a.current.value,password:s.current.value})},children:[Object(p.jsxs)("div",{className:"sign-in__fields",children:[Object(p.jsxs)("div",{className:"sign-in__field",children:[Object(p.jsx)("input",{className:"sign-in__input",type:"email",placeholder:"Email address",name:"user-email",id:"user-email",ref:a}),Object(p.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-email",children:"Email address"})]}),Object(p.jsxs)("div",{className:"sign-in__field",children:[Object(p.jsx)("input",{className:"sign-in__input",type:"password",placeholder:"Password",name:"user-password",id:"user-password",ref:s}),Object(p.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-password",children:"Password"})]})]}),Object(p.jsx)("div",{className:"sign-in__submit",children:Object(p.jsx)("button",{className:"sign-in__btn",type:"submit",children:"Sign in"})})]})}),Object(p.jsx)(Ae,{})]})};var Ge=function(){Object(i.useEffect)((function(){rt.dispatch(function(){var e=Object(L.a)(C.a.mark((function e(t,a,c){var r,i,s;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.get(n.Favorite);case 2:r=e.sent,i=r.data,s=i.map((function(e){return X(e)})),t(V(s));case 6:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}())}),[]);var e=Object(u.c)(je);return Object(p.jsxs)("div",{className:"user-page",children:[Object(p.jsxs)("header",{className:"page-header user-page__head",children:[Object(p.jsx)("div",{className:"logo",children:Object(p.jsx)(k,{})}),Object(p.jsx)("h1",{className:"page-title user-page__title",children:"My list"}),Object(p.jsx)(me,{})]}),Object(p.jsxs)("section",{className:"catalog",children:[Object(p.jsx)("h2",{className:"catalog__title visually-hidden",children:"Catalog"}),Object(p.jsx)(Fe,{filmsCount:e.length,films:e})]}),Object(p.jsx)(Ae,{})]})};function Ie(e){var t=new Date(e),a=t.getDate()<10?"0".concat(t.getDate()):t.getDate(),c=t.getMonth()<10?"0".concat(t.getMonth()+1):t.getMonth();return"".concat(t.getFullYear(),"-").concat(c,"-").concat(a)}function Ue(e){var t=new Date(e);return"".concat(_[t.getMonth()]," ").concat(t.getDate(),", ").concat(t.getFullYear())}var Pe=function(e){var t=e.film,a=e.author,c=e.dateTime,r=e.dateText,n=e.quote,i=e.rating,s=t.id;return Object(p.jsxs)("div",{className:"review",defaultValue:s,children:[Object(p.jsxs)("blockquote",{className:"review__quote",children:[Object(p.jsx)("p",{className:"review__text",children:n}),Object(p.jsxs)("footer",{className:"review__details",children:[Object(p.jsx)("cite",{className:"review__author",children:a}),Object(p.jsx)("time",{className:"review__date",dateTime:c,children:r})]})]}),Object(p.jsx)("div",{className:"review__rating",children:i})]})};function Me(e){var t=e.film,a=e.comments,c=e.tab,r=e.onClick,n=t.genre,i=t.released,s=t.rating,l=t.scoresCount,o=t.description,d=t.director,u=t.starring,j=t.runTime;function b(e){switch(!0){case e>=O.Bad&&e<O.Normal:return v.Bad;case e>=O.Normal&&e<O.Good:return v.Normal;case e>=O.Good&&e<O.VeryGood:return v.Good;case e>=O.VeryGood&&e<O.Awesome:return v.VeryGood;case e===O.Awesome:return v.Awesome}}function h(e){var t=Math.trunc(e/60)>0?Math.trunc(e/60):"",a=e%60;return"".concat(t,"h ").concat(a,"m")}return Object(p.jsxs)("div",{className:"film-card__desc",children:[Object(p.jsx)("nav",{className:"film-nav film-card__nav",children:Object(p.jsxs)("ul",{className:"film-nav__list",children:[Object(p.jsx)("li",{className:"film-nav__item ".concat(c===m.Overview?x:""),children:Object(p.jsx)("a",{className:"film-nav__link",onClick:function(){return r(m.Overview)},children:"Overview"})},m.Overview),Object(p.jsx)("li",{className:"film-nav__item ".concat(c===m.Details?x:""),children:Object(p.jsx)("a",{className:"film-nav__link",onClick:function(){return r(m.Details)},children:"Details"})},m.Details),Object(p.jsx)("li",{className:"film-nav__item ".concat(c===m.Reviews?x:""),children:Object(p.jsx)("a",{className:"film-nav__link",onClick:function(){return r(m.Reviews)},children:"Reviews"})},m.Reviews)]})}),function(e){switch(e){case m.Overview:return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"film-rating",children:[Object(p.jsx)("div",{className:"film-rating__score",children:s}),Object(p.jsxs)("p",{className:"film-rating__meta",children:[Object(p.jsx)("span",{className:"film-rating__level",children:b(s)}),Object(p.jsx)("span",{className:"film-rating__count",children:"".concat(l," ratings")})]})]}),Object(p.jsxs)("div",{className:"film-card__text",children:[Object(p.jsx)("p",{children:o}),Object(p.jsx)("p",{className:"film-card__director",children:Object(p.jsxs)("strong",{children:["Director: ",d]})}),Object(p.jsx)("p",{className:"film-card__starring",children:Object(p.jsxs)("strong",{children:["Starring: ",u.join(", ")," and other"]})})]})]});case m.Details:return Object(p.jsxs)("div",{className:"film-card__text film-card__row",children:[Object(p.jsxs)("div",{className:"film-card__text-col",children:[Object(p.jsxs)("p",{className:"film-card__details-item",children:[Object(p.jsx)("strong",{className:"film-card__details-name",children:"Director"}),Object(p.jsx)("span",{className:"film-card__details-value",children:d})]}),Object(p.jsxs)("p",{className:"film-card__details-item",children:[Object(p.jsx)("strong",{className:"film-card__details-name",children:"Starring"}),Object(p.jsx)("span",{className:"film-card__details-value",style:{whiteSpace:"pre-line"},children:u.join(", \n")})]})]}),Object(p.jsxs)("div",{className:"film-card__text-col",children:[Object(p.jsxs)("p",{className:"film-card__details-item",children:[Object(p.jsx)("strong",{className:"film-card__details-name",children:"Run Time"}),Object(p.jsx)("span",{className:"film-card__details-value",children:h(j)})]}),Object(p.jsxs)("p",{className:"film-card__details-item",children:[Object(p.jsx)("strong",{className:"film-card__details-name",children:"Genre"}),Object(p.jsx)("span",{className:"film-card__details-value",children:n})]}),Object(p.jsxs)("p",{className:"film-card__details-item",children:[Object(p.jsx)("strong",{className:"film-card__details-name",children:"Released"}),Object(p.jsx)("span",{className:"film-card__details-value",children:i})]})]})]});case m.Reviews:return Object(p.jsx)("div",{className:"film-card__reviews film-card__row",children:Object(p.jsx)("div",{className:"film-card__reviews-col",children:null!==a?a.map((function(e){return Object(p.jsx)(Pe,{film:t,author:e.user.name,dateTime:Ie(e.date),dateText:Ue(e.date),rating:e.rating,quote:e.comment},e.id)})):""})})}}(c)]})}var Ee=s.a.memo(Me);function Be(){var e=Object(j.h)().id;return Object(p.jsx)(N.a,{className:"btn film-card__button",to:"".concat(c.Film).concat(e).concat(c.AddReview),children:"Add review"})}var ze=s.a.memo(Be);var qe=function(){var e=Object(u.c)(xe),t=Object(u.c)(pe),a=Object(u.c)(oe),c=Object(u.c)(_e),l=s.a.useState(m.Overview),o=Object(Ne.a)(l,2),d=o[0],b=o[1],h=s.a.useCallback((function(e){return b(e)}),[]),f=Object(j.h)().id;return Object(i.useEffect)((function(){var e;rt.dispatch($(Number(f))),rt.dispatch((e=Number(f),function(){var t=Object(L.a)(C.a.mark((function t(a,c,r){var i,s,l;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.get("".concat(n.Films,"/").concat(e).concat(n.Similar));case 2:i=t.sent,s=i.data,l=s.map((function(e){return X(e)})),a(D(l));case 6:case"end":return t.stop()}}),t)})));return function(e,a,c){return t.apply(this,arguments)}}())),rt.dispatch(function(e){return function(){var t=Object(L.a)(C.a.mark((function t(a,c,r){var i,s;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.get("".concat(n.Comments,"/").concat(e));case 2:i=t.sent,s=i.data,a(G(s));case 5:case"end":return t.stop()}}),t)})));return function(e,a,c){return t.apply(this,arguments)}}()}(Number(f))),b(m.Overview)}),[f]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("section",{className:"film-card film-card--full",style:{backgroundColor:e.backgroundColor},children:[Object(p.jsxs)("div",{className:"film-card__hero",children:[Object(p.jsx)("div",{className:"film-card__bg",children:Object(p.jsx)("img",{src:e.backgroundImage,alt:e.name})}),Object(p.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(p.jsxs)("header",{className:"page-header film-card__head",children:[Object(p.jsx)("div",{className:"logo",children:Object(p.jsx)(k,{})}),Object(p.jsx)(me,{})]}),Object(p.jsx)("div",{className:"film-card__wrap",children:Object(p.jsxs)("div",{className:"film-card__desc",children:[Object(p.jsx)("h2",{className:"film-card__title",children:e.name}),Object(p.jsxs)("p",{className:"film-card__meta",children:[Object(p.jsx)("span",{className:"film-card__genre",children:e.genre}),Object(p.jsx)("span",{className:"film-card__year",children:e.released})]}),Object(p.jsxs)("div",{className:"film-card__buttons",children:[Object(p.jsx)(Re,{id:String(e.id)}),Object(p.jsx)(Se,{film:e}),a===r.Auth?Object(p.jsx)(ze,{}):""]})]})})]}),Object(p.jsx)("div",{className:"film-card__wrap film-card__translate-top",children:Object(p.jsxs)("div",{className:"film-card__info",children:[Object(p.jsx)("div",{className:"film-card__poster film-card__poster--big",children:Object(p.jsx)("img",{src:e.posterImage,alt:"".concat(e.name," poster"),width:"218",height:"327"})}),Object(p.jsx)(Ee,{tab:d,film:e,comments:t,onClick:h})]})})]}),Object(p.jsxs)("div",{className:"page-content",children:[Object(p.jsxs)("section",{className:"catalog catalog--like-this",children:[Object(p.jsx)("h2",{className:"catalog__title",children:"More like this"}),Object(p.jsx)(Fe,{filmsCount:4,films:c})]}),Object(p.jsx)(Ae,{})]})]})},Ve=[1,2,3,4,5,6,7,8,9,10];var We=function(){var e=Object(i.useState)(0),t=Object(Ne.a)(e,2),a=t[0],r=t[1],s=Object(i.useState)(""),l=Object(Ne.a)(s,2),o=l[0],d=l[1],m=Object(i.useState)(""),b=Object(Ne.a)(m,2),h=b[0],f=b[1],O=Object(i.useState)(!1),v=Object(Ne.a)(O,2),x=v[0],_=v[1],g=Object(j.h)().id,N=Object(u.b)(),w=function(e,t){N(function(e,t){var a=e.filmId,r=e.rating,i=e.comment;return function(){var e=Object(L.a)(C.a.mark((function e(s,l,o){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.post("".concat(n.Comments,"/").concat(a),{rating:r,comment:i}).then((function(e){var r=e.status,n=e.data;r>=400&&t("Error sending review. Try again later."),s(G(n)),s(q("".concat(c.Film).concat(String(a))))})).catch((function(){t("Error sending review. Try again later.")}));case 2:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}()}(e,t))};return Object(p.jsx)("div",{className:"add-review",children:Object(p.jsxs)("form",{action:"#",className:"add-review__form",onSubmit:function(e){e.preventDefault(),_(!0),null!==a&&null!==o&&w({filmId:Number(g),rating:Number(a),comment:o},(function(e){_(!1),f(e)}))},children:[""!==h?Object(p.jsx)("p",{style:{color:"red"},children:h}):"",Object(p.jsxs)("fieldset",{style:{border:"none",padding:0},disabled:x,children:[Object(p.jsx)("div",{className:"rating",children:Object(p.jsx)("div",{className:"rating__stars",children:Ve.map((function(e){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("input",{className:"rating__input",id:"star-".concat(e),type:"radio",name:"rating",value:e,onChange:function(){r(e)}},e),Object(p.jsxs)("label",{className:"rating__label",htmlFor:"star-".concat(e),children:["Rating ",e]})]})})).reverse()})}),Object(p.jsxs)("div",{className:"add-review__text",style:{background:"rgba(255, 255, 255, 0.4)"},children:[Object(p.jsx)("textarea",{className:"add-review__textarea",name:"review-text",id:"review-text",placeholder:"Review text",onChange:function(e){var t=e.target;d(t.value)},value:o}),Object(p.jsx)("div",{className:"add-review__submit",children:Object(p.jsx)("button",{className:"add-review__btn",type:"submit",disabled:!(a>0&&o.length>=50&&o.length<=400),children:"Post"})})]})]})]})})};var He=function(){var e=Object(u.c)(xe),t=Object(j.h)().id,a="".concat(e.name," poster"),c="/films/".concat(t);return Object(i.useEffect)((function(){rt.dispatch($(Number(t)))}),[t]),Object(p.jsxs)("section",{className:"film-card film-card--full",style:{backgroundColor:e.backgroundColor},children:[Object(p.jsxs)("div",{className:"film-card__header",children:[Object(p.jsx)("div",{className:"film-card__bg",children:Object(p.jsx)("img",{src:e.backgroundImage,alt:e.name})}),Object(p.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(p.jsxs)("header",{className:"page-header",children:[Object(p.jsx)("div",{className:"logo",children:Object(p.jsx)(k,{})}),Object(p.jsx)("nav",{className:"breadcrumbs",children:Object(p.jsxs)("ul",{className:"breadcrumbs__list",children:[Object(p.jsx)("li",{className:"breadcrumbs__item",children:Object(p.jsx)(N.a,{to:c,className:"breadcrumbs__link",children:e.name})}),Object(p.jsx)("li",{className:"breadcrumbs__item",children:Object(p.jsx)("a",{className:"breadcrumbs__link",children:"Add review"})})]})}),Object(p.jsx)(me,{})]}),Object(p.jsx)("div",{className:"film-card__poster film-card__poster--small",children:Object(p.jsx)("img",{src:e.posterImage,alt:a,width:"218",height:"327"})})]}),Object(p.jsx)(We,{})]})},Je=a(27),Ye=a.n(Je);var Xe=function(){var e=Object(i.useState)(!0),t=Object(Ne.a)(e,2),a=t[0],c=t[1],r=Object(i.useState)(!1),n=Object(Ne.a)(r,2),s=n[0],l=n[1],o=Object(i.useState)(0),d=Object(Ne.a)(o,2),m=d[0],b=d[1],h=Object(i.useState)(""),f=Object(Ne.a)(h,2),O=f[0],v=f[1],x=Object(i.useRef)(null),_=Object(j.h)().id,g=Object(j.g)(),N=Object(u.c)(xe).videoLink;return Object(i.useEffect)((function(){return null!==x.current&&(x.current.onloadstart=function(){x.current&&(x.current.poster="",x.current.style.background="black url(https://c.tenor.com/FX_9AcYeGokAAAAj/loader-loading.gif) center center no-repeat")},x.current.oncanplay=function(){x.current&&(x.current.style.background="",x.current.poster="img/player-poster.jpg")},x.current.onloadeddata=function(){c(!1),x.current&&v(Ye()(1e3*x.current.duration))}),function(){null!==x.current&&(x.current.onloadeddata=null,x.current=null)}}),[_]),Object(i.useEffect)((function(){null!==x.current&&(s?x.current.play():x.current.pause())}),[s]),Object(i.useEffect)((function(){rt.dispatch($(Number(_)))}),[_]),Object(p.jsxs)("div",{className:"player",children:[Object(p.jsx)("video",{src:N,ref:x,className:"player__video",poster:"img/player-poster.jpg",onTimeUpdate:function(e){var t;x.current&&(isNaN(null===(t=x.current)||void 0===t?void 0:t.duration)||(b(x.current.currentTime/x.current.duration*100),v(Ye()(1e3*(x.current.duration-x.current.currentTime)))))}}),Object(p.jsx)("button",{type:"button",className:"player__exit",onClick:function(){return g.goBack()},children:"Exit"}),Object(p.jsxs)("div",{className:"player__controls",children:[Object(p.jsxs)("div",{className:"player__controls-row",children:[Object(p.jsxs)("div",{className:"player__time",children:[Object(p.jsx)("progress",{className:"player__progress",value:m,max:"100"}),Object(p.jsx)("div",{className:"player__toggler",style:{left:"".concat(m,"%")},children:"Toggler"})]}),Object(p.jsxs)("div",{className:"player__time-value",children:["-",O]})]}),Object(p.jsxs)("div",{className:"player__controls-row",children:[s?Object(p.jsxs)("button",{type:"button",className:"player__play",onClick:function(){l(!1)},disabled:a,children:[Object(p.jsx)("svg",{viewBox:"0 0 14 21",width:"14",height:"21",children:Object(p.jsx)("use",{xlinkHref:"#pause"})}),Object(p.jsx)("span",{children:"Pause"})]}):Object(p.jsxs)("button",{type:"button",className:"player__play",onClick:function(){l(!0)},children:[Object(p.jsx)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:Object(p.jsx)("use",{xlinkHref:"#play-s"})}),Object(p.jsx)("span",{children:"Play"})]}),Object(p.jsx)("div",{className:"player__name",children:"Transpotting"}),Object(p.jsxs)("button",{type:"button",className:"player__full-screen",onClick:function(){var e;null===(e=x.current)||void 0===e||e.requestFullscreen()},children:[Object(p.jsx)("svg",{viewBox:"0 0 27 27",width:"27",height:"27",children:Object(p.jsx)("use",{xlinkHref:"#full-screen"})}),Object(p.jsx)("span",{children:"Full screen"})]})]})]})]})};var Ke=function(){return Object(p.jsxs)("div",{className:"user-page",children:[Object(p.jsx)("header",{className:"page-header user-page__head",children:Object(p.jsx)("div",{className:"logo",children:Object(p.jsx)(k,{})})}),Object(p.jsxs)("div",{className:"page-not-found",children:[Object(p.jsx)("h1",{className:"page-not-found__title",children:"404"}),Object(p.jsx)("p",{className:"page-not-found__text",children:"Oops! The page you were looking for was not found. "}),Object(p.jsx)(N.a,{className:"page-not-found__link",to:"/",children:"Back to home"})]}),Object(p.jsx)(Ae,{})]})};var Qe=function(e){var t=e.exact,a=e.path,n=e.render,i=Object(u.c)(oe);return Object(p.jsx)(j.b,{exact:t,path:a,render:function(e){return i===r.Auth?n(e):Object(p.jsx)(j.a,{to:c.Login})}})},Ze=a(10),$e=Object(Ze.a)();var et=function(e){var t=e.exact,a=e.path,n=e.render,i=Object(u.c)(oe);return Object(p.jsx)(j.b,{exact:t,path:a,render:function(e){return i===r.Auth&&a===c.Login?Object(p.jsx)(j.a,{to:c.Root}):n(e)}})};var tt=function(){return Object(u.c)(de)?Object(p.jsx)(j.c,{history:$e,children:Object(p.jsxs)(j.d,{children:[Object(p.jsx)(j.b,{exact:!0,path:c.Root,children:Object(p.jsx)(Te,{})}),Object(p.jsx)(j.b,{exact:!0,path:"/review",children:Object(p.jsx)(He,{})}),Object(p.jsx)(et,{exact:!0,path:c.Login,render:function(e){e.history;return Object(p.jsx)(De,{})}}),Object(p.jsx)(Qe,{exact:!0,path:c.MyList,render:function(e){e.history;return Object(p.jsx)(Ge,{})}}),Object(p.jsx)(Qe,{exact:!0,path:"".concat(c.Film,":id").concat(c.AddReview),render:function(){return Object(p.jsx)(He,{})}}),Object(p.jsx)(j.b,{exact:!0,path:"".concat(c.Film,":id"),children:Object(p.jsx)(qe,{})}),Object(p.jsx)(j.b,{exact:!0,path:"".concat(c.Player,":id"),children:Object(p.jsx)(Xe,{})}),Object(p.jsx)(j.b,{children:Object(p.jsx)(Ke,{})})]})}):Object(p.jsx)(g,{})},at=function(e){return function(e){return function(t){return t.type===y.RedirectToRoute&&$e.push(t.payload),e(t)}}},ct=function(e){var t=Y.a.create({baseURL:"https://8.react.pages.academy/wtw",timeout:5e3});return t.interceptors.response.use((function(e){return e}),(function(t){var a=t.response;return(null===a||void 0===a?void 0:a.status)===A.Unauthorized?e():Promise.reject(t)})),t.interceptors.request.use((function(e){var t=function(){var e=localStorage.getItem(H);return null!==e&&void 0!==e?e:""}();return t&&(e.headers["X-Token"]=t),e})),t}((function(){return rt.dispatch(E(r.NoAuth))})),rt=Object(d.a)({reducer:le,middleware:function(e){return e({thunk:{extraArgument:ct}}).concat(at)}});rt.dispatch(function(){var e=Object(L.a)(C.a.mark((function e(t,a,c){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.get(n.Login).then((function(e){var a=e.status,c=e.data;if(a&&a!==A.Unauthorized)return t(E(r.Auth)),void t(z(K(c)));t(E(r.NoAuth))}));case 2:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}()),rt.dispatch(function(){var e=Object(L.a)(C.a.mark((function e(t,a,c){var r,i,s;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.get(n.Films);case 2:r=e.sent,i=r.data,s=i.map((function(e){return X(e)})),t(S(s));case 6:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}()),rt.dispatch(function(){var e=Object(L.a)(C.a.mark((function e(t,a,c){var r,i,s;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.get(n.PromoFilm);case 2:r=e.sent,i=r.data,s=X(i),t(R(s));case 6:case"end":return e.stop()}}),e)})));return function(t,a,c){return e.apply(this,arguments)}}()),o.a.render(Object(p.jsx)(s.a.StrictMode,{children:Object(p.jsx)(u.a,{store:rt,children:Object(p.jsx)(tt,{})})}),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.a3e7f60d.chunk.js.map